LagTime
bval <-0.023
Tmin <--5.647
#ratemax<-(bval*(Temp-T_min))
sqrtrate<-c()
for (i in -5:35){
ratemax<-(bval*(i-T_min))
sqrtrate<-c(sqrtrate,ratemax)
}
sqrtrate<-c()
Timeseq<-seq(-5,35)
for (i in Timeseq){
ratemax<-(bval*(i-T_min))
sqrtrate<-c(sqrtrate,ratemax)
}
plot(x = Timeseq, y = sqrtrate)
sqrtrate<-c()
Timeseq<-seq(-5,35)
for (i in Timeseq){
ratemax<-(bval*(i-T_min))^2
sqrtrate<-c(sqrtrate,ratemax)
}
plot(x = Timeseq, y = sqrtrate)
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-4
ratemax<-(bval*(Temp-T_min))
ratemax
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-4
ratemax<-(bval*(Temp-T_min))^2
ratemax
Temp<-4
ratemax<-(bval*(Temp-T_min))
ratemax
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-4
ratemax<-(bval*(Temp-T_min))
ratemax
sqrtrate<-c()
sqrtrate<-c()
Timeseq<-seq(-5,35)
for (i in Timeseq){
ratemax<-(bval*(i-T_min))
sqrtrate<-c(sqrtrate,ratemax)
}
plot(x = Timeseq, y = sqrtrate)
Temp<-4
ratemax<-(bval*(Temp-T_min))^2
ratemax
ratemax<-(bval*(Temp-T_min))^2/2.303
ratemax
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-10
ratemax<-(bval*(Temp-T_min))^2/2.303
ratemax
#Ratworsky
bval <-0.023
Tmin <--5.647
Temp<-10
ratemax<-(bval*(Temp-T_min))^2/log(10)
ratemax
bval <- 0.03347 #+-0.0002
T_min <- -7.7
Temp<- 4
Time<-24
Temp<- 25
rate = (bval*(Temp-T_min))^2/2.303
rate
LagTime = 1/rate
LagTime
rate
Time<-24
Temp<- 4
rate = (bval*(Temp-T_min))^2/2.303
rate
LagTime = 1/rate
LagTime
1/0.35
1/0.035
1/1.1
install.packages("plotly")
data<-read.csv("3d-df-11-13.csv")
setwd("~/GitHub/CPS-Farm-to-Facility/Model/R Analysis")
data<-read.csv("3d-df-11-13.csv")
library("plotly")
library("tidyverse")
library("ggplot2")
fig <- plot_ly(data = data, x = ~Grabs, y = ~SampleMass, z = ~Clusters, color = ~PH_CFU_PerA)
fig <- fig %>% add_markers()
fig <- fig %>% layout(scene = list(xaxis = list(title = 'Grabs'),
yaxis = list(title = 'Sample Mass'),
zaxis = list(title = 'Clustering Level')))
fig
fig <- plot_ly(data = data, x = ~Grabs, y = ~SampleMass, z = ~Clusters, color = ~PH_CFU_PerA)
fig <- fig %>% add_markers()
fig <- fig %>% layout(scene = list(xaxis = list(title = 'Grabs'),
yaxis = list(title = 'Sample Mass'),
zaxis = list(title = 'Clustering Level')))
fig
Summarizeddata<-data %>%
group_by(Clusters,ContLevel,Grabs,SampleMass) %>%
summarise(meanpa = mean(PH_CFU_PerA))
ggplotdata<-Summarizeddata %>%
filter(meanpa>=0.95)
ggplot(ggplotdata, aes(x= Grabs, y=SampleMass, color= factor(Clusters) ))+
geom_line()
P1 <-Summarizeddata[1:25,]
library(reshape2)
Matrix<-acast(P1, Grabs~SampleMass, value.var="meanpa")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
)
fig
P1 <-Summarizeddata[1:25,]
library(reshape2)
Matrix<-acast(P1, Grabs~SampleMass, value.var="meanpa")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'))
fig
P1 <-Summarizeddata[1:25,]
library(reshape2)
Matrix<-acast(P1, Grabs~SampleMass, value.var="meanpa")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'))
fig
View(Summarizeddata)
P1 <-Summarizeddata[1:25,]
library(reshape2)
Matrix<-acast(P1, Grabs~SampleMass, value.var="meanpa")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cluster: 1% , Cont Level: -4 log CFU/g")
fig
P2 <-Summarizeddata[26:50,]
library(reshape2)
Matrix<-acast(P2, Grabs~SampleMass, value.var="meanpa")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cluster: 1% , Cont Level: -3 log CFU/g" )
fig
P3 <-Summarizeddata[51:75,]
library(reshape2)
Matrix<-acast(P3, Grabs~SampleMass, value.var="meanpa")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cluster: 1% , Cont Level: -2 log CFU/g" ,legend = list(title=list(text='<b> Power, P of Rejection</b>')))
fig
P4 <-Summarizeddata[76:100,]
library(reshape2)
Matrix<-acast(P4, Grabs~SampleMass, value.var="meanpa")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cluster: 1% , Cont Level: -1 log CFU/g" ,legend = list(title=list(text='<b> Power, P of Rejection</b>')))
fig
Summarizeddata<-data %>%
group_by(Clusters,ContLevel,Grabs,SampleMass) %>%
summarise(meanpa = mean(PH_CFU_PerA))
ggplotdata<-Summarizeddata %>%
filter(meanpa>=0.95)
View(ggplotdata)
Summarizeddata<-data %>%
group_by(Clusters,ContLevel,Grabs,SampleMass) %>%
summarise(meanpa = mean(PH_CFU_PerA)) %>%
mutate(meanpr = 1-meanpa)
ggplotdata<-Summarizeddata %>%
filter(meanpr>=0.95)
View(ggplotdata)
View(Summarizeddata)
ggplotdata<-Summarizeddata %>%
filter(meanpr>=0.95, ContLevel ==3.657056)
View(Summarizeddata)
ggplotdata<-Summarizeddata %>%
filter(meanpr>=0.95, ContLevel == "3.657056")
View(Summarizeddata)
ggplotdata<-Summarizeddata %>%
filter(meanpr>=0.95) %>%
filter(ContLevel==3.657056)
class(Summarizeddata$ContLevel)
Summarizeddata$ContLevel
Summarizeddata$ContLevel[1]
Summarizeddata<-data %>%
group_by(Clusters,ContLevel,Grabs,SampleMass) %>%
summarise(meanpa = mean(PH_CFU_PerA)) %>%
mutate(meanpr = 1-meanpa)
ggplotdata<-Summarizeddata %>%
filter(meanpr>=0.95) %>%
filter(ContLevel==3.657056)
ggplotdata<-Summarizeddata %>%
filter(meanpr>=0.95)
ggplotdata<-Summarizeddata %>%
filter(meanpr>=0.95) %>%
filter(ContLevel == 4.657056)
ggplotdata<-Summarizeddata %>%
filter(meanpr>=0.95) %>%
filter(ContLevel == 4.657056)
Summarizeddata<-data %>%
group_by(Clusters,ContLevel,Grabs,SampleMass) %>%
summarise(meanpa = mean(PH_CFU_PerA)) %>%
mutate(meanpr = 1-meanpa)
ggplotdata<-Summarizeddata %>%
filter(meanpr>=0.95)
ggplot(ggplotdata, aes(x= Grabs, y=SampleMass, color= factor(Clusters) ))+
geom_line()
ggplotdata<-Summarizeddata %>%
filter(meanpr>=0.95) %>%
arrange(desc(COntLevel))
ggplotdata<-Summarizeddata %>%
filter(meanpr>=0.95) %>%
arrange(desc(ContLevel))
P1_Summary <-ggplotdata[12:67,]
Matrix<-acast(P1, Grabs~SampleMass, value.var="Clusters")
View(Matrix)
P1_Summary <-ggplotdata[12:67,]
Matrix<-acast(P1_Summary, Grabs~SampleMass, value.var="Clusters")
Matrix<-acast(P1_Summary, Grabs~SampleMass, value.var="Clusters")
View(P1_Summary)
P1_Summary <-ggplotdata[302:362,]
P1_Summary
Matrix<-acast(P1_Summary, Grabs~SampleMass, value.var="Clusters")
P1_Summary <-ggplotdata[302:362,]
P1_Summary %>%
group_by(Grabs,SampleMass) %>%
summarise(Clusters = mean(Clusters)) %>%
Matrix<-acast(P1_Summary, Grabs~SampleMass, value.var="Clusters")
P1_Summary <-ggplotdata[302:362,]
P1_Summary<-P1_Summary %>%
group_by(Grabs,SampleMass) %>%
summarise(Clusters = mean(Clusters))
Matrix<-acast(P1_Summary, Grabs~SampleMass, value.var="Clusters")
View(Matrix)
P1_Summary <-ggplotdata[302:362,]
P1_Summary<-P1_Summary %>%
group_by(Grabs,SampleMass) %>%
summarise(Clusters = mean(Clusters))
Matrix<-acast(P1_Summary, Grabs~SampleMass, value.var="Clusters")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cluster: 1% , Cont Level: -3 log CFU/g" ,legend = list(title=list(text='<b> Power, P of Rejection</b>')))
fig
P1_Summary <-ggplotdata[302:362,]
P1_Summary<-P1_Summary %>%
group_by(Grabs,SampleMass) %>%
summarise(Clusters = mean(Clusters))
Matrix<-acast(P1_Summary, Grabs~SampleMass, value.var="Clusters")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cluster: 1% , Cont Level: -3 log CFU/g" ,legend = list(title=list(text='Cluster Size')))
fig
P1_Summary <-ggplotdata[302:362,]
P1_Summary<-P1_Summary %>%
group_by(Grabs,SampleMass) %>%
summarise(Clusters = mean(Clusters))
Matrix<-acast(P1_Summary, Grabs~SampleMass, value.var="Clusters")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cont Level: -2 log CFU/g" ,legend = list(title=list(text='Cluster Size')))
fig
View(Matrix)
View(data)
ggplotdata<-data %>%
mutate(PR = 1-PH_CFU_PerA) %>%
filter(PR>=0.95) %>%
arrange(desc(ContLevel))
P1_Summary <-ggplotdata$ContLevel==3.657056
sum(P1_Summary)
ggplotdata$ContLevel<-as.numeric(ggplotdata$ContLevel)
P1_Summary <-ggplotdata$ContLevel==3.657056
sum(P1_Summary)
P1_Summary <-ggplotdata[15001:30000]
P1_Summary<-P1_Summary %>%
group_by(Grabs,SampleMass) %>%
summarise(Clusters = mean(Clusters))
Matrix<-acast(P1_Summary, Grabs~SampleMass, value.var="Clusters")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cont Level: -2 log CFU/g" ,legend = list(title=list(text='Cluster Size')))
fig
ggplotdata<-data %>%
mutate(PR = 1-PH_CFU_PerA) %>%
filter(PR>=0.95) %>%
arrange(desc(ContLevel))
P1_Summary <-ggplotdata[15001:30000]
P1_Summary<-P1_Summary %>%
group_by(Grabs,SampleMass) %>%
summarise(Clusters = mean(Clusters))
Matrix<-acast(P1_Summary, Grabs~SampleMass, value.var="Clusters")
ggplotdata<-data %>%
mutate(PR = 1-PH_CFU_PerA) %>%
filter(PR>=0.95) %>%
arrange(desc(ContLevel))
P1_Summary <-ggplotdata[15001:30000,]
P1_Summary<-P1_Summary %>%
group_by(Grabs,SampleMass) %>%
summarise(Clusters = mean(Clusters))
Matrix<-acast(P1_Summary, Grabs~SampleMass, value.var="Clusters")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cont Level: -2 log CFU/g" ,legend = list(title=list(text='Cluster Size')))
fig
P1_Summary <-ggplotdata[15001:30000,]
P1_Summary<-P1_Summary %>%
group_by(Grabs,SampleMass) %>%
summarise(Clusters = mean(Clusters))
Matrix<-acast(P1_Summary, Grabs~SampleMass, value.var="Clusters")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cont Level: -2 log CFU/g" ,legend = list(title=list(text='Cluster Size')))
fig
P2_Summary <-ggplotdata[1:15000,]
P2_Summary<-P2_Summary %>%
group_by(Grabs,SampleMass) %>%
summarise(Clusters = mean(Clusters))
Matrix<-acast(P1_Summary, Grabs~SampleMass, value.var="Clusters")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cont Level: -3 log CFU/g" ,legend = list(title=list(text='Cluster Size')))
fig
P3_Summary <-ggplotdata[31000:45000,]
P3_Summary<-P3_Summary %>%
group_by(Grabs,SampleMass) %>%
summarise(Clusters = mean(Clusters))
Matrix<-acast(P1_Summary, Grabs~SampleMass, value.var="Clusters")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cont Level: -3 log CFU/g" ,legend = list(title=list(text='Cluster Size')))
fig
P2_Summary <-ggplotdata[1:15000,]
P2_Summary<-P2_Summary %>%
group_by(Grabs,SampleMass) %>%
summarise(Clusters = mean(Clusters))
Matrix<-acast(P2_Summary, Grabs~SampleMass, value.var="Clusters")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cont Level: -4 log CFU/g" ,legend = list(title=list(text='Cluster Size')))
fig
P3_Summary <-ggplotdata[31000:45000,]
P3_Summary<-P3_Summary %>%
group_by(Grabs,SampleMass) %>%
summarise(Clusters = mean(Clusters))
Matrix<-acast(P3_Summary, Grabs~SampleMass, value.var="Clusters")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cont Level: -3 log CFU/g" ,legend = list(title=list(text='Cluster Size')))
fig
P4_Summary <-ggplotdata[45001:60000,]
P4_Summary<-P4_Summary %>%
group_by(Grabs,SampleMass) %>%
summarise(Clusters = mean(Clusters))
Matrix<-acast(P4_Summary, Grabs~SampleMass, value.var="Clusters")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cont Level: -3 log CFU/g" ,legend = list(title=list(text='Cluster Size')))
fig
P4_Summary <-ggplotdata[45001:60000,]
P4_Summary<-P4_Summary %>%
group_by(Grabs,SampleMass) %>%
summarise(Clusters = mean(Clusters))
Matrix<-acast(P4_Summary, Grabs~SampleMass, value.var="Clusters")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cont Level: -3 log CFU/g" ,legend = list(title=list(text='Cluster Size')))
fig
P4_Summary <-ggplotdata[45001:60000,]
P4_Summary<-P4_Summary %>%
group_by(Grabs,SampleMass) %>%
summarise(Clusters = mean(Clusters))
Matrix<-acast(P4_Summary, Grabs~SampleMass, value.var="Clusters")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cont Level: -1 log CFU/g" ,legend = list(title=list(text='Cluster Size')))
fig
P2_Summary <-ggplotdata[1:11319,]
P2_Summary<-P2_Summary %>%
group_by(Grabs,SampleMass) %>%
summarise(Clusters = mean(Clusters))
Matrix<-acast(P2_Summary, Grabs~SampleMass, value.var="Clusters")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cont Level: 0 log CFU/g" ,legend = list(title=list(text='Cluster Size')))
fig
P1_Summary <-ggplotdata[11320:22635,]
P1_Summary<-P1_Summary %>%
group_by(Grabs,SampleMass) %>%
summarise(Clusters = mean(Clusters))
Matrix<-acast(P1_Summary, Grabs~SampleMass, value.var="Clusters")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cont Level: -3 log CFU/g" ,legend = list(title=list(text='Cluster Size')))
fig
View(Matrix)
P2_Summary <-ggplotdata[1:11319,]
P2_Summary<-P2_Summary %>%
group_by(Grabs,SampleMass) %>%
summarise(Clusters = mean(Clusters))
Matrix<-acast(P2_Summary, Grabs~SampleMass, value.var="Clusters")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cont Level: 0 log CFU/g" ,legend = list(title=list(text='Cluster Size')))
fig
View(P2_Summary)
P1 <-Summarizeddata[1:25,]
library(reshape2)
Matrix<-acast(P1, Grabs~SampleMass, value.var="meanpa")
fig <- plot_ly(
x = c(60,120,300,600,1200),
y = c(1,30,60,120,300),
z = Matrix,
type = "contour"
) %>%
layout(yaxis = list(title = 'Number of grabs/specimens'),xaxis = list(title = 'Composite Sample Mass (g)'), title = "Cluster: 1% , Cont Level: -3 log CFU/g" ,legend = list(title=list(text='<b> Power, P of Rejection</b>')))
fig
